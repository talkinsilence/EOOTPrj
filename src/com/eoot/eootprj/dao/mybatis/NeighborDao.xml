<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
    <mapper namespace="com.eoot.eootprj.dao.NeighborDao">
    	
    	<insert id="insertNei" parameterType="Neighbor">
    		INSERT INTO NEIGHBORS(ASKMID, ACCEPTMID, ASKREGDATE, STATE) VALUES(#{ASKID}, #{ACCEPTMID}, GETDATE(), 0);
    	</insert>
    	
    	<select id="getNeiInvs" parameterType="String" resultType="NeighborJoinMember">
    		SELECT * FROM NEIGHBORS N INNER JOIN MEMBERS M ON N.ASKMID = M.MID WHERE N.ACCEPTMID = #{acceptmid} AND state = 0;
    	</select>
    	
    	<select id="getNeiInvsMe" parameterType="String" resultType="NeighborJoinMember">
    		SELECT * FROM NEIGHBORS F INNER JOIN MEMBERS M ON F.ACCEPTMID = M.MID WHERE F.ASKMID = #{uid} AND state = 0;
    	</select>
    	
    	<select id="getNeighbors" parameterType="String" resultType="NeighborJoinMember">
    		SELECT * FROM NEIGHBORS N INNER JOIN MEMBERS M ON N.ASKMID = M.MID WHERE N.ACCEPTMID = #{uid} AND state = 1;
    	</select>
    	
    	<delete id="deleteInvMe" parameterType="String">
    		DELETE FROM NEIGHTBORS WHERE ASKMID = #{param1} AND ACCEPTMID = #{param2}
    	</delete>
    </mapper>